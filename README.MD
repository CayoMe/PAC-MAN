# paCman, um Pacman em C

O jogo, rodando estritamente no console, funciona a partir de um loop localizado no `int main()` do documento principal, que ocorre logo ap√≥s alguns preparos do cen√°rio e a renderiza√ß√£o do cen√°rio em si.

**Este loop consiste em 4 fun√ß√µes principais:**
- `makeMove()`: recebe uma entrada do usu√°rio. Podem ser setas para movimentar o Pacman ou letras para algumas fun√ß√µes b√°sicas como encerrar ou reiniciar.
- `moverFantasma()`: move o fantasma de acordo com a sua velocidade, armazenada no `struct` *"Fantasma"*. Ser√° trocada pela fun√ß√£o `moverFantasmas()` quando terminarmos a l√≥gica do fantasma.
- `checkWin()`: verifica algumas condi√ß√µes para encerrar o jogo. Se o Pacman tiver comido todas as bolinhas, o jogador vence. Se o Pacman estiver na mesma coordenada que um fantasma, Game Over.
- `renderGrid()`: busca as informa√ß√µes do mapa ap√≥s todas as movimenta√ß√µes e printa no console cada uma das c√©lulas do mapa.
---
## Notas
- Os nomes de algumas fun√ß√µes s√£o links pra facilitar a navega√ß√£o. Clique nelas :^]
- Os macros `ROWS` e `COLS` s√£o necess√°rios porque o C exije que, sempre que uma matriz for passada para uma fun√ß√£o, a quantidade de linhas e colunas t√™m de ser passadas tamb√©m. Utilizar esses macros √© √∫til pois assim n√£o precisamos ficar mudando todas as dimens√µes toda vez que decidirmos alterar o tamanho dos [mapas](#mapas), √© s√≥ mudar a constante l√° no `#define`.

---
## As Entidades
### Pacman `C`
√â o jogador. Todas as vezes que a fun√ß√£o `makeMove()` √© chamada, o jogador dever√° pressionar uma das teclas permitidas: qualquer seta, (Q)uit, (R)einiciar.

### Fantasmas `F`
S√£o monstrinhos que andam aleatoriamente pelo mapa e se, ao final do turno, as suas coordenadas forem iguais √† do Pacman, o jogador perde e o jogo acaba.
Possuem vari√°veis de coordenadas (`xPos` e `yPos`), de velocidade (`xVel` e `yVel`), e de `skin`. A *skin* √© o s√≠mbolo que aparece no mapa para representar o fantasma.
Em cada turno, as coordenadas do fantasma s√£o incrementadas por suas respectivas velocidades atr√°v√©s das l√≥gicas `yPos = yPos + yVel` para a coordenada das linhas, e `xPos = xPos + xVel` para a coordenada das colunas.
> *Exemplo:* um fantasma posicionado na c√©lula **(3, 7)** e com os os valores de velocidade `xVel = -1` e `yVel = 0` se movimentar√° para a c√©lula **(2, 7)** no turno seguinte. *Veja [coordenadas](#coordenadas).*

Note que um dos valores de velocidade tem de ser 0, se n√£o o fantasma se mover√° em diagonais.
Sempre que um fantasma fica de frente com uma parede, os valores de sua velocidade mudam para que no pr√≥ximo turno ele se mova em outra dire√ß√£o. H√° mais detalhes na descri√ß√£o da fun√ß√£o [`moverFantasma()`](#moverfantasma).
**TODO:** podemos fazer com que os fantasmas sigam o Pacman sempre que eles tiverem "vis√£o" dele. Ser√° necess√°rio uma fun√ß√£o `olhar()` dentro da [`moverFantasma()`](#moverfantasma) que seja chamada antes de tudo. Caso ele esteja na vis√£o, a uma vers√£o especial da fun√ß√£o [`mudarDirecao()`](#mudardirecao) √© chamada.

---

## Os Mapas
Para evitar que as l√≥gica do jogador e a dos fantasmas entrem em conflito, o jogador e os fantasmas vivem em mapas diferentes, o [mapa principal](#mapa-principal) e o [fantasmapa](#fantasmapa).
Estes mapas s√£o reflexos um do outro. Toda parede no mapa principal tamb√©m √© uma parede no fantasmapa. mas as [entidades](#as-entidades) de um n√£o habitam o outro, mas o c√≥digo permite que elas se "comuniquem".

### Mapa principal
Referido apenas como *"mapa"*, √© o mapa em que o Pacman vive. Nele estar√£o presentes o [Pacman](#pacman), 

### Fantasmapa

---
## Coordenadas
Devido a como o C e outras linguagens de programa√ß√£o representam os √≠ndices de matrizes, h√° um pouco de espa√ßo para confus√£o na maneira em que nos referimos √† coordenadas.
No plano coordenadas cartesianas (x, y), "andar pra direita" √© incrementar o valor de x, enquanto "andar para cima" √© incrementar o valor de y.
Em matrizes, n√£o funciona bem assim. A linguagem C indexa as c√©lulas da esquerda pra direita, de cima pra baixo, como a nossa leitura, portanto, **o menor valor de x (colunas) fica na esquerda, enquanto o menor valor de y (linha) fica no topo.**
Em cima de tudo isso, para acessar uma c√©lula em uma matriz `char m[4][4]`, devemos cham√°-la da seguinte forma: `m[#linha][#coluna]`, ou seja **o valor de y vem primeiro!**
A tabela abaixo mostra a nota√ß√£o tanto em forma cartesiana quanto em indexa√ß√£o do C.

| .         | x = 0             | x = 1             | x = 2             | x = 3             |
|----------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|
| **y = 0** | (0, 0)<br>m[0][0] | (1, 0)<br>m[0][1] | (2, 0)<br>m[0][2] | (3, 0)<br>m[0][3] |
| **y = 1** | (0, 1)<br>m[1][0] | (1, 1)<br>m[1][1] | (2, 1)<br>m[1][2] | (3, 1)<br>m[1][3] |
| **y = 2** | (0, 2)<br>m[2][0] | (1, 2)<br>m[2][1] | (2, 2)<br>m[2][2] | (3, 2)<br>m[2][3] |
| **y = 3** | (0, 3)<br>m[3][0] | (1, 3)<br>m[3][1] | (2, 3)<br>m[3][2] | (3, 3)<br>m[3][3] |

Por conta disso, sempre que, no c√≥digo, √© necess√°rio referenciar alguma c√©lula no mapa, voc√™ ver√° algo do tipo: `fm[ fan->yPos + fan->yVel ][ fan->xPos + fan->xVel ]`. **O valor de y SEMPRE vir√° antes do valor de x**. √â confuso assim mesmo e t√° tudo bem üò∂ü§ô

---

## Fun√ß√µes
### `moverFantasma()`
`void moverFantasma(Fantasma *fan, char fm[ROWS][COLS]);`
Recebe um ponteiro para o fantasma e a matriz do [Fantasmapa](#fantasmapa) DONKEY

---

### Debugs
Em alguns locais do c√≥digo est√£o presentes o coment√°rio `// DEBUG` seguido de um n√∫mero. **Ex:** `// DEBUG 2`.
Estas linhas servem como algumas ferramentas visuais que podem ser utilizadas para debugar o jogo. Coment√°-las faz com que elas n√£o apare√ßam mais no console, permitindo ver como o jogo seria ao finaliz√°-lo.
> Dica: Use `crtl + F` para buscar o debug espec√≠fico que quer habilitar/desabilitar, selecione o texto, `ctrl + shift + L` para criar um cursor em cada debug, `ctrl + ;` para comentar todas as linhas.